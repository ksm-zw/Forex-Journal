(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53276,e=>{"use strict";var t=e.i(43476),a=e.i(46932);function r({children:e,className:r="",...s}){return(0,t.jsx)(a.motion.div,{initial:{opacity:0,y:8,scale:.995},whileInView:{opacity:1,y:0,scale:1},whileHover:{y:-4},whileTap:{scale:.995},viewport:{once:!0,amount:.15},transition:{type:"spring",stiffness:260,damping:22},className:`card ${r}`,...s,children:e})}e.s(["default",()=>r])},18924,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(66427),s=e.i(5766),l=e.i(92199);function i({onRecordingSaved:e}){let r=(0,a.useRef)(null),i=(0,a.useRef)([]),[d,o]=(0,a.useState)(!1),[n,c]=(0,a.useState)(0),[x,m]=(0,a.useState)([]),[h,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e;return d&&(e=setInterval(()=>{c(e=>e+1)},1e3)),()=>clearInterval(e)},[d]);let u=async()=>{try{let t=await navigator.mediaDevices.getUserMedia({audio:!0});r.current=new MediaRecorder(t),i.current=[],r.current.ondataavailable=e=>{i.current.push(e.data)},r.current.onstop=()=>{let t=new Blob(i.current,{type:"audio/webm"}),a=URL.createObjectURL(t),r={id:Date.now().toString(),url:a,duration:n,timestamp:new Date};m(e=>[r,...e]),e?.(a)},r.current.start(),o(!0),c(0)}catch(e){s.default.error("Unable to access microphone"),console.error(e)}},b=e=>{let t=Math.floor(e/60);return`${t}:${(e%60).toString().padStart(2,"0")}`};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Voice Notes"}),(0,t.jsx)("div",{className:"flex items-center gap-4 mb-4",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>{r.current&&d&&(r.current.stop(),o(!1),r.current.stream.getTracks().forEach(e=>e.stop()))},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:[(0,t.jsx)(l.FiStopCircle,{className:"w-5 h-5"}),"Stop"]}),(0,t.jsx)("div",{className:"text-lg font-bold text-red-600 dark:text-red-400",children:b(n)}),(0,t.jsx)("div",{className:"flex-1 h-1 bg-red-300 dark:bg-red-900 rounded-full relative overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-red-600 animate-pulse",style:{width:"30%"}})})]}):(0,t.jsxs)("button",{onClick:u,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:[(0,t.jsx)(l.FiMic,{className:"w-5 h-5"}),"Start Recording"]})}),x.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Recordings"}),x.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-slate-700 p-3 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("button",{onClick:()=>g(h===e.id?null:e.id),className:"btn-compact bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:(0,t.jsx)(l.FiPlay,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.timestamp.toLocaleTimeString()}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:b(e.duration)})]})]}),(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void m(e=>e.filter(e=>e.id!==t))},className:"p-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:(0,t.jsx)(l.FiTrash2,{className:"w-4 h-4"})})]},e.id))]})]}),h&&(0,t.jsx)("audio",{src:x.find(e=>e.id===h)?.url,autoPlay:!0,controls:!0,className:"w-full"},h)]})}function d({onScreenshotAdded:e}){let r=(0,a.useRef)(null),[i,d]=(0,a.useState)([]),[o,n]=(0,a.useState)(null),[c,x]=(0,a.useState)(""),m=async t=>{let a=t.currentTarget.files;if(a){for(let t of Array.from(a))try{let a=new FileReader;a.onload=t=>{let a=t.target?.result,r={id:Date.now().toString()+Math.random(),url:a,caption:"",timestamp:new Date};d(e=>[r,...e]),e?.(a),s.default.success("Screenshot uploaded")},a.readAsDataURL(t)}catch(e){s.default.error("Failed to upload screenshot"),console.error(e)}r.current&&(r.current.value="")}},h=(e,t)=>{d(a=>a.map(a=>a.id===e?{...a,caption:t}:a)),n(null)};return(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Trade Setup Screenshots"}),(0,t.jsxs)("div",{onClick:()=>r.current?.click(),className:"border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[(0,t.jsx)(l.FiUpload,{className:"w-8 h-8 mx-auto mb-2 text-gray-600 dark:text-gray-400"}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Click to upload or drag & drop"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"}),(0,t.jsx)("input",{ref:r,type:"file",multiple:!0,accept:"image/*",onChange:m,className:"hidden"})]}),i.length>0&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Uploads"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.map(e=>(0,t.jsxs)("div",{className:"relative group bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:[(0,t.jsx)("img",{src:e.url,alt:"Trade setup",className:"w-full h-40 object-cover"}),(0,t.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-between p-2",children:[(0,t.jsx)("button",{onClick:()=>{var t,a;let r;return t=e.url,a=e.timestamp,void((r=document.createElement("a")).href=t,r.download=`trade-setup-${a.toISOString()}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r))},className:"btn-compact bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",title:"Download",children:(0,t.jsx)(l.FiDownload,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void d(e=>e.filter(e=>e.id!==t))},className:"p-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Delete",children:(0,t.jsx)(l.FiX,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-600",children:o===e.id?(0,t.jsx)("input",{autoFocus:!0,type:"text",value:c,onChange:e=>x(e.target.value),onBlur:()=>h(e.id,c),onKeyPress:t=>{"Enter"===t.key&&h(e.id,c)},placeholder:"Add caption...",className:"w-full px-2 py-1 border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-xs focus:ring-2 focus:ring-blue-500 outline-none"}):(0,t.jsx)("p",{onClick:()=>{n(e.id),x(e.caption)},className:"text-xs text-gray-600 dark:text-gray-400 cursor-pointer hover:text-gray-900 dark:hover:text-white",children:e.caption||"Click to add caption..."})})]},e.id))})]})]})})}var o=e.i(53276);function n(){let[e,l]=(0,a.useState)(!1),[n,c]=(0,a.useState)(null),[x,m]=(0,a.useState)([]),[h,g]=(0,a.useState)({whatLearned:"",mistakes:[],emotionalState:"calm",setupQuality:3}),[u,b]=(0,a.useState)("");(0,a.useEffect)(()=>{l(!0)},[]),(0,a.useEffect)(()=>{e&&(async()=>{try{let e=await fetch("/api/trades",{headers:{"x-user-id":"demo-user"}});if(!e.ok){let t=null;try{t=await e.json()}catch(a){t=await e.text()}console.error("Failed to fetch trades:",e.status,t),m([]);return}let t=await e.json();if(!Array.isArray(t)){console.warn("Unexpected trades payload in review page",t),m([]);return}m(t)}catch(e){console.error("Error fetching trades:",e)}})()},[e]);let p=x.find(e=>e.id===n),y=async()=>{if(p)try{(await fetch(`/api/trades/${p.id}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({whatLearned:h.whatLearned,mistakes:JSON.stringify(h.mistakes),emotionalState:h.emotionalState,setupQuality:h.setupQuality})})).ok&&(s.default.success("Review saved"),c(null))}catch(e){s.default.error("Failed to save review")}};return e?(0,t.jsxs)("div",{className:"min-h-screen bg-white dark:bg-slate-950",children:[(0,t.jsx)(r.default,{}),(0,t.jsxs)("main",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Trade Reviews"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Deep dive into your trades and learn from them"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)(o.default,{className:"bg-white dark:bg-slate-800 p-4 border border-gray-200 dark:border-slate-700",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Recent Trades"}),(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:x.length>0?x.map(e=>(0,t.jsxs)("button",{onClick:()=>{c(e.id),g({whatLearned:e.whatLearned||"",mistakes:e.mistakes?JSON.parse(e.mistakes):[],emotionalState:e.emotionalState||"calm",setupQuality:e.setupQuality||3})},className:`w-full text-left p-3 rounded-lg transition-colors ${n===e.id?"bg-blue-600 text-white":"bg-gray-50 dark:bg-slate-700 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-slate-600"}`,children:[(0,t.jsx)("div",{className:"font-semibold text-sm",children:e.pair}),(0,t.jsx)("div",{className:"text-xs opacity-75",children:new Date(e.entryTime).toLocaleDateString()})]},e.id)):(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No trades yet"})})]}),p?(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)(o.default,{className:"bg-white dark:bg-slate-800 p-4 border border-gray-200 dark:border-slate-700",children:[(0,t.jsxs)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:[p.pair," - ",p.direction]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Entry"}),(0,t.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:p.entryPrice.toFixed(5)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Exit"}),(0,t.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:p.exitPrice?.toFixed(5)||"Open"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"P&L"}),(0,t.jsx)("p",{className:`font-semibold ${p.profitLoss>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:p.profitLoss?.toFixed(2)||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Outcome"}),(0,t.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:p.outcome||"Open"})]})]})]}),(0,t.jsxs)(o.default,{className:"bg-white dark:bg-slate-800 p-4 border border-gray-200 dark:border-slate-700",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Review Details"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"What I Learned"}),(0,t.jsx)("textarea",{value:h.whatLearned,onChange:e=>g(t=>({...t,whatLearned:e.target.value})),placeholder:"What did this trade teach you?",className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-none h-20"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Emotional State"}),(0,t.jsxs)("select",{value:h.emotionalState,onChange:e=>g(t=>({...t,emotionalState:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,t.jsx)("option",{children:"calm"}),(0,t.jsx)("option",{children:"rushed"}),(0,t.jsx)("option",{children:"frustrated"}),(0,t.jsx)("option",{children:"confident"}),(0,t.jsx)("option",{children:"fearful"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Setup Quality Rating"}),(0,t.jsxs)("select",{value:h.setupQuality,onChange:e=>g(t=>({...t,setupQuality:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,t.jsx)("option",{value:"1",children:"⭐ Poor"}),(0,t.jsx)("option",{value:"2",children:"⭐⭐ Below Average"}),(0,t.jsx)("option",{value:"3",children:"⭐⭐⭐ Average"}),(0,t.jsx)("option",{value:"4",children:"⭐⭐⭐⭐ Good"}),(0,t.jsx)("option",{value:"5",children:"⭐⭐⭐⭐⭐ Excellent"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Mistakes Made"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["Overtraded","Broke rules","Wrong entry point","Hesitated on trade","Exited too early","Exited too late","Ignored analysis","Bad position sizing","Emotion-driven"].map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:h.mistakes.includes(e),onChange:()=>{g(t=>({...t,mistakes:t.mistakes.includes(e)?t.mistakes.filter(t=>t!==e):[...t.mistakes,e]}))},className:"w-4 h-4 rounded border-gray-300 dark:border-slate-600"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})]},e))})]})]}),(0,t.jsx)("button",{onClick:y,className:"w-full btn-primary disabled:opacity-50 transition-colors text-center",children:"Save Review"})]}):(0,t.jsx)(o.default,{className:"lg:col-span-2 bg-white dark:bg-slate-800 p-6 text-center border border-gray-200 dark:border-slate-700",children:(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Select a trade to review"})})]}),p&&(0,t.jsxs)("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsx)(o.default,{className:"p-6",children:(0,t.jsx)(i,{})}),(0,t.jsx)(o.default,{className:"p-6",children:(0,t.jsx)(d,{})})]})]}),(0,t.jsx)(s.Toaster,{position:"bottom-right"})]}):(0,t.jsx)("div",{className:"min-h-screen bg-white dark:bg-slate-950"})}e.s(["default",()=>n],18924)}]);